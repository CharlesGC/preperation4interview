<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>

    <div id="test">
        test
    </div>
    <ul id="ul">
        <li>1</li>
        <li>2</li>
        <li>3</li>
        <li>4</li>
        <li>5</li>
    </ul>
    <h1>
        <div></div>
    </h1>

    <style type="text/css">
        #page {
            width: 520px;
        }

        .nav {
            width: 200px;
            float: right;
        }

        .main {
            width: 200px;
            float: left;
            padding-left: 110px;
        }

        .sub {
            width: 100px;
            float: left;
            margin: 10px 0 10px -100px;
        }

        .main {
            border: 1px solid #000;
        }

        .nav,
        .sub {
            border: 1px dashed #000;
            height: 300px;
        }

        .sub {
            height: 280px;
        }
    </style>
    <div id="page">
        <div class="main">
            <div class="sub"></div>
        </div>
        <div class="nav"></div>
    </div>

    <script>
        // function toRGB(color){
        //     let reg1 = /^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/gi;
        //     let reg2 = /^#([0-9a-f]{1})([0-9a-f]{1})([0-9a-f]{1})$/gi;
        //     if(color.length===7){
        //         let arr = color.match(reg1);
        //         return "rgb("+parseInt(arr[1],16)+","+parseInt(arr[2],16)+","+parseInt(arr[3],16)+")"
        //     }
        //     else if(color.length===4){
        //         let arr = color.match(reg2);
        //         return "rgb("+parseInt(arr[1],16)+","+parseInt(arr[2],16)+","+parseInt(arr[3],16)+")"
        //     }
        //     else{
        //         return color;
        //     }
        // }    

        // // 创建空数组，并与索引作为元素
        // function createArr(length){
        //     // 展开运算符+from
        //     // return [...Array.from({length:length}).keys()];

        //     return Object.keys(Array.apply(null,{length:length}));

        // }
        // createArr(100);

        // 数组乱序
        // function shuffle(arr){
        //     return arr.sort((a,b)=>{
        //         return Math.random() > 0.5 ? 1: -1;
        //     });
        // }
        // console.log(shuffle([1,2,3,4,5,6,7,8,9]));

        // 数组前十个数求和
        // function sum(arr, count){

        //     let ret = arr.reduce((acc,current, index)=>{
        //         if(index<count){
        //             return acc + current
        //         }
        //         else{
        //             return acc;
        //         }
        //     },0);
        //     return ret;
        // }
        // console.log(sum([1,2,3,4,5,6,7,8,9],2));

        // var a = 6;
        // setTimeout(function () {
        //     alert(a);
        //     a = 666;
        // }, 1000);
        // a = 66;

        // let testElm = document.getElementById("test");
        // testElm.addEventListener("click",function(e){
        //     alert("i am capture")
        // },true);
        // testElm.addEventListener("click",function(e){
        //     alert("i am propogation");
        // }, false);

        // let reg = /^\s+|\s+$/g;
        // " abc ".replace(reg,"");


        // let emailReg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+$/g;

        // let test = (function(a){
        //     this.a = a;
        //     return function(b){
        //         return this.a + b;
        //     }
        // }(function(a){
        //     return a;
        // }(1,2)));

        // console.log(test(4));

        // function sleep (time) {
        //     return new Promise((resolve) => setTimeout(resolve, time));
        // }
        // sleep(2000).then(function(value){
        //     console.log("2s later exec");            
        // });


        // let ul = document.getElementById("ul");
        // ul.addEventListener("click", function(e){
        //     let target = e.target;
        //     if(target && target.nodeName.toUpperCase()==="LI"){
        //         alert(target.innerHTML);
        //     }
        // }, false);

        // function doSomething(){
        //     alert(this);
        // }
        // let test = document.getElementById("test");
        // test.onclick = doSomething;
        // test.onclick = function(){
        //     doSomething();
        // }
        // doSomething();

        // 排序算法
        // function sort(arr){
        //     // 冒泡排序
        //     // let len = arr.length;            
        //     // for (let i = 0; i < len; i++) {
        //     //     for (let j = 0; j < len-1-i; j++) {
        //     //         if(arr[j]>arr[j+1]){
        //     //             [arr[j], arr[j+1]] = [arr[j+1],arr[j]]
        //     //         }                  
        //     //     }                
        //     // }

        //     // 选择排序
        //     let len = arr.length;
        //     let minIndex;
        //     for (let index = 0; index < len; index++) {
        //         minIndex = index;
        //         for (let j = index; j < len; j++) {
        //             if(arr[j]<arr[minIndex]){
        //                 minIndex = j;
        //             }              
        //         }
        //         if(index !== minIndex){
        //             [arr[index], arr[minIndex]] = [arr[minIndex], arr[index]];
        //         }
        //     }

        //     return arr;
        // }
        // console.log(sort([10,1,20,5,-12]));

        // 查询字符串正则表达式
        // let urlParamsReg = //g;
        // function getParams(name){
        //     let reg = "[\\?&]"+name+"=([^&#]*)";
        //     let regex = new RegExp(reg);
        //     let results = regex.exec(location.href);
        //     return results ? "" : results[1];
        // }
        // getParams("test");


        /**
         * 判断是否是基本数据类型
         * @param value 
         */
        function isPrimitive(value) {
            return (typeof value === 'string' ||
                typeof value === 'number' ||
                typeof value === 'symbol' ||
                typeof value === 'boolean')
        }

        /**
         * 判断是否是一个js对象
         * @param value 
         */
        function isObject(value) {
            return Object.prototype.toString.call(value) === "[object Object]"
        }

        /**
         * 深拷贝一个值
         * @param value 
         */
        function cloneDeep(value) {

            // 记录被拷贝的值，避免循环引用的出现
            let memo = {};

            function baseClone(value) {
                let res;
                // 如果是基本数据类型，则直接返回
                if (isPrimitive(value)) {
                    return value;
                    // 如果是引用数据类型，我们浅拷贝一个新值来代替原来的值
                } else if (Array.isArray(value)) {
                    res = [...value];
                } else if (isObject(value)) {
                    res = {
                        ...value
                    };
                }

                // 检测我们浅拷贝的这个对象的属性值有没有是引用数据类型。如果是，则递归拷贝
                Reflect.ownKeys(res).forEach(key => {
                    if (typeof res[key] === "object" && res[key] !== null) {
                        //此处我们用memo来记录已经被拷贝过的引用地址。以此来解决循环引用的问题
                        if (memo[res[key]]) {
                            res[key] = memo[res[key]];
                        } else {
                            memo[res[key]] = res[key];
                            res[key] = baseClone(res[key])
                        }
                    }
                })
                return res;
            }

            return baseClone(value)
        }

        // 判断两个对象是否相等
        // https://www.jb51.net/article/110768.htm
        function isEqual(a,b){
            //如果a和b本来就全等
            if(a===b){
                //判断是否为0和-0
                return a !== 0 || 1/a ===1/b;
            }
            //判断是否为null和undefined
            if(a==null||b==null){
                return a===b;
            }
            //接下来判断a和b的数据类型
            var classNameA=toString.call(a),
                classNameB=toString.call(b);
            //如果数据类型不相等，则返回false
            if(classNameA !== classNameB){
                return false;
            }
            //如果数据类型相等，再根据不同数据类型分别判断
            switch(classNameA){
                case '[object RegExp]':
                case '[object String]':
                //进行字符串转换比较
                return '' + a ==='' + b;
                case '[object Number]':
                //进行数字转换比较,判断是否为NaN
                if(+a !== +a){
                return +b !== +b;
                }
                //判断是否为0或-0
                return +a === 0?1/ +a === 1/b : +a === +b;
                case '[object Date]':
                case '[object Boolean]':
                return +a === +b;
            }
            //如果是对象类型
            if(classNameA == '[object Object]'){
                //获取a和b的属性长度
                var propsA = Object.getOwnPropertyNames(a),
                propsB = Object.getOwnPropertyNames(b);
                if(propsA.length != propsB.length){
                return false;
                }
                for(var i=0;i<propsA.length;i++){
                var propName=propsA[i];
                //如果对应属性对应值不相等，则返回false
                if(a[propName] !== b[propName]){
                    return false;
                }
                }
                return true;
            }
            //如果是数组类型
            if(classNameA == '[object Array]'){
                if(a.toString() == b.toString()){
                return true;
                }
                return false;
            }
        }
    
        // https://blog.csdn.net/qq_37746973/article/details/78662177       
        function buildTree(list){
            let temp = {};
            let tree = {};
            for(let i in list){
                temp[list[i].id] = list[i];
            }
            for(let i in temp){
                if(temp[i].parent_id) {
                    if(!temp[temp[i].parent_id].children) {
                        temp[temp[i].parent_id].children = new Object();
                    }
                    temp[temp[i].parent_id].children[temp[i].id] = temp[i];
                } else {
                    tree[temp[i].id] =  temp[i];
                }
            }
            return tree;
        }
        var menu_list = [{
            id: '1',
            menu_name: '设置',
            menu_url: 'setting',
            parent_id: 0
            }, {
            id: '1-1',
            menu_name: '权限设置',
            menu_url: 'setting.permission',
            parent_id: '1'
            }, {
            id: '1-1-1',
            menu_name: '用户管理列表',
            menu_url: 'setting.permission.user_list',
            parent_id: '1-1'
            }, {
            id: '1-1-2',
            menu_name: '用户管理新增',
            menu_url: 'setting.permission.user_add',
            parent_id: '1-1'
            }, {
            id: '1-1-3',
            menu_name: '角色管理列表',
            menu_url: 'setting.permission.role_list',
            parent_id: '1-1'
            }, {
            id: '1-2',
            menu_name: '菜单设置',
            menu_url: 'setting.menu',
            parent_id: '1'
            }, {
            id: '1-2-1',
            menu_name: '菜单列表',
            menu_url: 'setting.menu.menu_list',
            parent_id: '1-2'
            }, {
            id: '1-2-2',
            menu_name: '菜单添加',
            menu_url: 'setting.menu.menu_add',
            parent_id: '1-2'
            }, {
            id: '2',
            menu_name: '订单',
            menu_url: 'order',
            parent_id: 0
            }, {
            id: '2-1',
            menu_name: '报单审核',
            menu_url: 'order.orderreview',
            parent_id: '2'
            }, {
            id: '2-2',
            menu_name: '退款管理',
            menu_url: 'order.refundmanagement',
            parent_id: '2'
            }
        ];
        console.log(buildTree(menu_list));


    </script>
</body>

</html>